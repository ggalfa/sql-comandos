/*

FAZENDO UM SELECT SIMPLES QUANDO SE DESEJA
OBTER REGISTRO DE UMA COM CONDICAO DE UMA COLUNA ESPCIFICA.

*/

select * FROM NF_NFCE WHERE NF_SITUACAO_NFC = '00';

/*

FAZENDO SELECT E TRAZENDO INFORMAÇOES DE MAIS DE UM CAMPO DE UMA DETERMINADA 
TABELA E COLOCANDO UMA CONDIÇÃO LÓGICA.

*/

select CODIGO_IBGE, NOME_IBGE, UF_IBGE from tab_ibge where NOME_IBGE = 'Teresina' and UF_IBGE = 'PI';

/*
PARA BUSCAR POR UMA TABELA ESPECIFICA DENTRO UM
COMANDO FAZEMOS O SEGUINTE:

*/

select TIPOVENDA_NFC FROM WHERE NF_SITUACAO_NFC = '00';

/*
CONVERTANDO DATA COM CAST PARA FAZER UM FILTRO

USANDO O BETWEEN PARA PEGAR VALORES DENTRO DE
UM PERIODO INICIAL E FINAL.

ESSA CONVERSAO É NECESSÁRIO POIS O CAMPO DATAEMISSAO
POSSUI HORA EX:
'01.01.2019 10:20'
POR ISSO O CAST É NECESSÁRIO PARA PEGAR O CAMPO nf_dataemissao_nfc
E TRANSFORMAR EM DATA COM as date.

*/

select * from nf_nfce
where  cast( nf_dataemissao_nfc as date) between '16.03.2017' and '30.03.2017'

/* 

POSSO INFORMAÇOES DE MAIS DE UMA TABELA DESDE QUE A CONDICAO 
EXISTA NAS DUAS TABELAS.

NO EXEMPLO ABAIXO NF_NFCE E NF_NFCPRODUTOS ESTAO LIGADAS
PORQUE TODO NFCE TEM PRODUTOS E OS PRODUTOS
POSSUEM COFINS E FCP.

TAMBEM PODEMOS AINDA TRAZER APENAS AS INFORMÇOES DE 
UM PERÍODO ESPECÍFICO.

*/

select PRODUTONOME_NFCPROD, COFINS_NFC, FCPVALOR_NFC FROM NF_NFCE, nf_nfcprodutos WHERE NF_SITUACAO_NFC = '00'
AND cast( nf_dataemissao_nfc as date) between '16.03.2017' and '30.03.2017'

/*

FAZENDO UM UPADATE COM SQL
NA TABELA PESSOAS O CAMPO NOME_PES SERA ATUALIZADO PARA 'LENO VENDEDOR'
ONDE NOME_PES FOR IGUAL 'LENO PROFESSOR'.

*/

UPDATE pessoas SET NOME_PES = 'LENO VENDEDOR' WHERE NOME_PES = 'LENO PROFESSOR';

/*

USANDO ORDER BY PARA AGRUPAR PELO NOME DA CIDADE
E TRAZENDO O CODIGO IBGE E NOME DA CIDADE

*/

select CODIGO_IBGE, NOME_IBGE from tab_ibge where UF_IBGE = 'PI'   ORDER BY NOME_IBGE;

/*

USANDO O INNER JOIN PODEMOS JUNTAR DUAS TABELAS NO EXEMPLO
ABAIXO DAMOS UM SELECT EM NF_NFCE NA COLUNA TURNO_NFC
E NA TABELA nf_nfcepagamentos NO COLUNA moeda_nfcpgto
E ENTAO ENTRAMOS EM NF_NFCE E JUNTAMOS nf_nfcepagamentos

*/

select nf_nfce.turno_nfc, nf_nfcepagamentos.moeda_nfcpgto from nf_nfce
join nf_nfcepagamentos on nf_nfce.id_numero_nfc = nf_nfcepagamentos.moeda_nfcpgto;

/* 
SELECIONADO A VENDA COM PREÇO MAX DA TABLE NF_NFCE
*/

SELECT MAX( VALORTOTAL_NFC ) AS soma
FROM nf_nfce;

/*

USANDO SUM PARA TRAZER A SOMA TOTAL DAS VENDAS DA TABELA 
NF_NFCE
*/

SELECT SUM( VALORTOTAL_NFC ) AS total
FROM nf_nfce;

/* 
PODEMOS AINDA TRAZER O TOTAL DAS VENDAS DE UM DETERMINADO
PERIODO USANDO O BETWEEN PARA PEGAR VALORES ENTRE X e Y
E A FUNCAO CAST ESTA SENDO USADA PARA CONVERTER DATAS 
QUE SAO STRINGS EM DATAS NORMAIS COM A FUNCAO DATE
O AS TOTAL CRIA UM APELIDO PRA 
SELECT SUM( VALORTOTAL_NFC ) COM NOME DE total.

*/

SELECT SUM( VALORTOTAL_NFC ) AS total
FROM nf_nfce where NF_SITUACAO_NFC = '00'
AND cast( nf_dataemissao_nfc as date)
between '16.03.2017' and '30.03.2017';